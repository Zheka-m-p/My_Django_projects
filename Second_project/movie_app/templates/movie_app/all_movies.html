{% extends 'movie_app/base_movie.html' %}

{% block title %} Все фильмы {% endblock %}

{% block body %}
<a href="{% url 'movie:movie_app_home_page' %}">← На главную</a>  <!-- ← ссылка назад -->

<div style="max-width: 800px; margin: 20px auto; padding: 20px;">
    <h2 style="text-align: center; color: #333;">Список всех фильмов</h2>

    <div style="display: grid; gap: 15px;">
        {% for movie in movies %}
        <div style="padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: #f9f9f9;">
            <h3 style="margin: 0; color: #007bff;">
                <a href="{{ movie.get_absolute_url }}" style="text-decoration: none;">
                    {{ movie.name }}
                </a>
            </h3>
            <p style="margin: 8px 0; color: #555;">
                Рейтинг: <strong>{{ movie.rating }}%</strong>,
                Режиссер: <strong>{{ movie.producer.first_name|default:"Не известно" }}
                {{ movie.producer.last_name|default:"" }}</strong>,  <!-- ← добавлен default -->
                Год: <strong>{{ movie.year|default:"неизвестен" }}</strong>,
                Бюджет: <strong>{{ movie.budget|default:"оч много)" }}</strong>
            </p>
        </div>
        {% empty %}
        <p style="text-align: center; color: #999;">Фильмов пока нет.</p>
        {% endfor %}
    </div>

    <!-- Статистика -->
    {% if stats %}
    <div style="margin-top: 20px; padding: 15px; background-color: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 8px;">
        <h3 style="margin: 0; color: #0056b3;">Статистика</h3>
        <p style="margin: 8px 0; color: #004085;">
            Всего фильмов: <strong>{{ stats.count_film }}</strong>,
            Средний бюджет: <strong>{{ stats.avg_budget|floatformat:0 }}</strong>,
            Макс. рейтинг: <strong>{{ stats.max_rating }}</strong>,
            Мин. год: <strong>{{ stats.min_year|default:"—" }}</strong>,
            Макс. год: <strong>{{ stats.max_year|default:"—" }}</strong>
        </p>
    </div>
    {% endif %}
</div>
{% endblock %}